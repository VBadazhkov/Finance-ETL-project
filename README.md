# üìÉ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π ETL-–ø–∞–π–ø–ª–∞–π–Ω, –∫–æ—Ç–æ—Ä—ã–π:
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å–≤–µ—á–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞—Ö (Kline) —Å –±–∏—Ä–∂–∏ Bybit —á–µ—Ä–µ–∑ API.
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è).
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö ClickHouse.
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å –ø–æ–º–æ—â—å—é Airflow DAG.
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ Apache superset

# üì± C—Ç–µ–∫
Python - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ETL-–ª–æ–≥–∏–∫–∏

Pandas - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

ClickHouse - —Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

Airflow - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤

Bybit API - –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (—Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

Apache superset - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã

# üìà –û–ø–∏—Å–∞–Ω–∏–µ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞
- Extract (–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API Bybit v5

–ó–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–∞—Ä BTCUSDT –∏ ETHUSDT.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:

–¢–∞–π–º—Ñ—Ä–µ–π–º: 1 —á–∞—Å (60 –º–∏–Ω—É—Ç)

–ü–µ—Ä–∏–æ–¥: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞

- Transform (–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è)
–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

–ö–æ–ª–æ–Ω–∫–∏: open_time, open, high, low, close, volume, turnover.

–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏:

UTC ‚Üí –ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è (Europe/Moscow).

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

load_date ‚Äî –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

- Load (–ó–∞–≥—Ä—É–∑–∫–∞ –≤ ClickHouse)
–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—ã:
```
default.BTCUSDT
default.ETHUSDT
```
–î–≤–∏–∂–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è: ReplacingMergeTree (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ load_date).

–ö–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ –ë–î - –≤ queries.sql

# ü™Å Airflow DAG
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DAG

–ò–º—è DAG: ParseBybitKline

–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –ö–∞–∂–¥—ã–π —á–∞—Å –≤ :05 –∏ :55.

–û–ø–∏—Å–∞–Ω–∏–µ: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å Bybit.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

catchup=False ‚Äî –ø—Ä–æ–ø—É—Å–∫ –ø—Ä–æ—à–ª—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤.

max_active_runs=1 ‚Äî —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫.

- –ó–∞–¥–∞—á–∏ (Tasks)
ParseBybitKline_task:

–í—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é main(), –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è BTCUSDT –∏ ETHUSDT.

# üï∏ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤ ClickHouse (—Å–º. 'queries.sql').
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ ETL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î (–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
    DATABASE_PASSWORD=–ø–∞—Ä–æ–ª—å_–æ—Ç_–±–¥
    DATABASE_USER=–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    PORT=–ø–æ—Ä—Ç)

–î–∞—à–±–æ—Ä–¥ –≤ –ø–∞–ø–∫–µ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ Apache superset.
–¢–∞–∫–∂–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å DAG –≤ Airflow —Å –∫–æ–¥–æ–º –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞ main_script.py

# ‚ùó –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- Python 3.8+
- Airflow
- ClickHouse
- Apache superset
