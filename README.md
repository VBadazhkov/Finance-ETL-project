# Описание проекта
Проект представляет собой ETL-пайплайн, который:
- Извлекает данные о свечных графиках (Kline) с биржи Bybit через API.
- Трансформирует данные (приводит к нужному формату, конвертирует время).
- Загружает в базу данных ClickHouse.
- Автоматизирует процесс с помощью Airflow DAG.
- Визуализирует данные в Yandex DataLens.

2. Технологический стек
Python - основной язык разработки ETL-логики
Pandas - обработка и трансформация данных
ClickHouse - ранение данных
Airflow - оркестрация ETL-процессов
Bybit API - Источник данных (рыночные данные)
DataLens - Визуализация и дашборды

3. Описание ETL-процесса
- Extract (Извлечение данных)
Используется API Bybit v5
Запрашиваются данные для пар BTCUSDT и ETHUSDT.
Параметры запроса:
Таймфрейм: 1 час (60 минут)
Период: последние 24 часа

- Transform (Трансформация)
Структурирование данных:
Колонки: open_time, open, high, low, close, volume, turnover.
Конвертация времени:
UTC → Московское время (Europe/Moscow).
Добавление данных:
load_date — время загрузки данных.

- Load (Загрузка в ClickHouse)
Данные сохраняются в таблицы:
default.BTCUSDT
default.ETHUSDT
Движок хранения: ReplacingMergeTree (автоматическая дедупликация по load_date).

Код для создания таблиц в БД - в queries.sql

4. Airflow DAG
- Настройка DAG
Имя DAG: ParseBybitKline
Расписание: Каждый час в :05 и :55.
Описание: Автоматическая загрузка данных с Bybit.
Параметры:
catchup=False — пропуск прошлых запусков.
max_active_runs=1 — только один активный запуск.

- Задачи (Tasks)
ParseBybitKline_task:
Вызывает функцию main(), которая загружает данные для BTCUSDT и ETHUSDT.

5. Развертывание
- Создайте таблицы в ClickHouse (см. 'queries.sql').
- Запустите ETL-скрипт для заполнения данных в БД (Необходимо создать файл .env с параметрами:
    DATABASE_PASSWORD=пароль_от_бд
    DATABASE_USER=имя_пользователя
    PORT=порт)

Импортируйте воркбук в DataLens, при импорте укажите свои: хост, ClickHouse порт, логин/пароль
Также для автоматизации подгрузки данных необходимо создать DAG в Airflow с кодом из скрипта main_script.py

6. Требования:
установлены
- Python 3.8+
- Airflow
- ClickHouse
- DataLens
